sudo: no
dist: trusty

language: c

compiler:
    - gcc

# notifications:
#     email:
#        recipients:
#            - darnir@gmail.com
#            - bug-wget@gnu.org
#        on_success: change
#        on_failure: always

env:
    global:
        - PERLLIB=$PERLLIB:../../tests
        - PERL5LIB=$PERL5LIB:../../tests
    matrix:
        - SSL=""
        - SSL="openssl"
        - SSL="gnutls"
        - TOOLKIT=true
addons:
    apt:
        packages:
            - automake
            - autoconf
            - autopoint
            - flex
            - texinfo
            - pkg-config
            - libgnutls-dev
            - libssl-dev
            - make
            - libhttp-daemon-perl
            - libio-socket-ssl-perl
            - libidn2-0-dev
            - gettext
            - texlive
            - python3
            - valgrind
            - language-pack-tr
            - language-pack-ru

script: |
    if [[ $TOOLKIT = true ]]; then
      make distclean || true
      ./bootstrap
      ./contrib/travis-ci $SSL
    else
      bash <(curl -s https://runtimeverification.com/toolkit/docker/bash) nightly-2018-08-30
    fi
